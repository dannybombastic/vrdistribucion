class ContactForm{constructor(){this.form=document.querySelector("#contact form"),this.submitButton=this.form?.querySelector('button[type="submit"]'),this.isSubmitting=!1,this.apiUrl=this.getApiUrl(),this.init()}getApiUrl(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"0.0.0.0"===window.location.hostname||"3000"===window.location.port?"http://127.0.0.1:8000/api/contact":"https://vrdistribucion.com/api/contact"}init(){this.form&&(this.form.addEventListener("submit",(e=>this.handleSubmit(e))),this.addRealTimeValidation())}async handleSubmit(e){if(e.preventDefault(),this.isSubmitting)return;if(this.clearErrors(),!this.validateForm())return;const t=this.getFormData();try{this.setSubmitting(!0);const e=await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();e.ok&&r.success?(this.showSuccess(r.message),this.resetForm()):this.showError(r.error||"Error al enviar el mensaje")}catch(e){this.showError("Error de conexión. Por favor intenta nuevamente.")}finally{this.setSubmitting(!1)}}getFormData(){return{name:this.form.querySelector("#contact-name")?.value.trim(),email:this.form.querySelector("#contact-email")?.value.trim(),phone:this.form.querySelector("#contact-phone")?.value.trim(),message:this.form.querySelector("#contact-message")?.value.trim(),timestamp:(new Date).toISOString()}}validateForm(){let e=!0;const t=this.form.querySelector("#contact-name");t?.value.trim()?t.value.trim().length<2&&(this.showFieldError("name-error","El nombre debe tener al menos 2 caracteres"),e=!1):(this.showFieldError("name-error","El nombre es obligatorio"),e=!1);const r=this.form.querySelector("#contact-email");r?.value.trim()?this.isValidEmail(r.value.trim())||(this.showFieldError("email-error","Por favor ingresa un email válido"),e=!1):(this.showFieldError("email-error","El email es obligatorio"),e=!1);const o=this.form.querySelector("#contact-phone");o?.value.trim()&&!this.isValidPhone(o.value.trim())&&(this.showFieldError("phone-error","Por favor ingresa un teléfono válido"),e=!1);const i=this.form.querySelector("#contact-message");return i?.value.trim()?i.value.trim().length<10&&(this.showFieldError("message-error","El mensaje debe tener al menos 10 caracteres"),e=!1):(this.showFieldError("message-error","El mensaje es obligatorio"),e=!1),e}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){const t=e.replace(/[\s\-\(\)]/g,"");return/^\d{10,13}$/.test(t)}addRealTimeValidation(){["#contact-name","#contact-email","#contact-phone","#contact-message"].forEach((e=>{const t=this.form.querySelector(e);t&&(t.addEventListener("blur",(()=>this.validateField(t))),t.addEventListener("input",(()=>this.clearFieldError(t))))}))}validateField(e){const t=e.id,r=e.value.trim();switch(t){case"contact-name":r?r.length<2&&this.showFieldError("name-error","El nombre debe tener al menos 2 caracteres"):this.showFieldError("name-error","El nombre es obligatorio");break;case"contact-email":r?this.isValidEmail(r)||this.showFieldError("email-error","Por favor ingresa un email válido"):this.showFieldError("email-error","El email es obligatorio");break;case"contact-phone":r&&!this.isValidPhone(r)&&this.showFieldError("phone-error","Por favor ingresa un teléfono válido");break;case"contact-message":r?r.length<10&&this.showFieldError("message-error","El mensaje debe tener al menos 10 caracteres"):this.showFieldError("message-error","El mensaje es obligatorio");break}}showFieldError(e,t){const r=document.getElementById(e);r&&(r.textContent=t,r.style.display="block")}clearFieldError(e){let t="";switch(e.id){case"contact-name":t="name-error";break;case"contact-email":t="email-error";break;case"contact-phone":t="phone-error";break;case"contact-message":t="message-error";break}if(t){const e=document.getElementById(t);e&&(e.style.display="none",e.textContent="")}}clearErrors(){this.form.querySelectorAll(".error-message").forEach((e=>{e.style.display="none",e.textContent=""}))}showSuccess(e){const t=document.getElementById("form-success-message");t&&(t.textContent=e,t.style.display="block",setTimeout((()=>{t.style.display="none"}),5e3))}showError(e){const t=document.getElementById("form-general-error");t&&(t.textContent=e,t.style.display="block")}setSubmitting(e){this.isSubmitting=e,this.submitButton&&(this.submitButton.disabled=e,this.submitButton.textContent=e?"Enviando...":"Enviar Mensaje")}resetForm(){this.form.reset(),this.clearErrors()}}document.addEventListener("DOMContentLoaded",(()=>{new ContactForm})),window.ContactForm=ContactForm;